(self.webpackChunkguias_eoscostarica_io=self.webpackChunkguias_eoscostarica_io||[]).push([[3768],{3905:function(e,n,a){"use strict";a.d(n,{Zo:function(){return d},kt:function(){return _}});var o=a(7294);function i(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function t(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,o)}return a}function s(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach((function(n){i(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function r(e,n){if(null==e)return{};var a,o,i=function(e,n){if(null==e)return{};var a,o,i={},t=Object.keys(e);for(o=0;o<t.length;o++)a=t[o],n.indexOf(a)>=0||(i[a]=e[a]);return i}(e,n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(o=0;o<t.length;o++)a=t[o],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var c=o.createContext({}),l=function(e){var n=o.useContext(c),a=n;return e&&(a="function"==typeof e?e(n):s(s({},n),e)),a},d=function(e){var n=l(e.components);return o.createElement(c.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},u=o.forwardRef((function(e,n){var a=e.components,i=e.mdxType,t=e.originalType,c=e.parentName,d=r(e,["components","mdxType","originalType","parentName"]),u=l(a),_=i,g=u["".concat(c,".").concat(_)]||u[_]||p[_]||t;return a?o.createElement(g,s(s({ref:n},d),{},{components:a})):o.createElement(g,s({ref:n},d))}));function _(e,n){var a=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var t=a.length,s=new Array(t);s[0]=u;var r={};for(var c in n)hasOwnProperty.call(n,c)&&(r[c]=n[c]);r.originalType=e,r.mdxType="string"==typeof e?e:i,s[1]=r;for(var l=2;l<t;l++)s[l]=a[l];return o.createElement.apply(null,s)}return o.createElement.apply(null,a)}u.displayName="MDXCreateElement"},3919:function(e,n,a){"use strict";function o(e){return!0===/^(\w*:|\/\/)/.test(e)}function i(e){return void 0!==e&&!o(e)}a.d(n,{b:function(){return o},Z:function(){return i}})},4996:function(e,n,a){"use strict";a.d(n,{C:function(){return t},Z:function(){return s}});var o=a(2263),i=a(3919);function t(){var e=(0,o.Z)().siteConfig,n=(e=void 0===e?{}:e).baseUrl,a=void 0===n?"/":n,t=e.url;return{withBaseUrl:function(e,n){return function(e,n,a,o){var t=void 0===o?{}:o,s=t.forcePrependBaseUrl,r=void 0!==s&&s,c=t.absolute,l=void 0!==c&&c;if(!a)return a;if(a.startsWith("#"))return a;if((0,i.b)(a))return a;if(r)return n+a;var d=a.startsWith(n)?a:n+a.replace(/^\//,"");return l?e+d:d}(t,a,e,n)}}}function s(e,n){return void 0===n&&(n={}),(0,t().withBaseUrl)(e,n)}},429:function(e,n,a){"use strict";a.r(n),a.d(n,{frontMatter:function(){return c},contentTitle:function(){return l},metadata:function(){return d},toc:function(){return p},default:function(){return _}});var o=a(2122),i=a(9756),t=(a(7294),a(3905)),s=a(4996),r=["components"],c={id:"instalacion-de-red-privada",title:"Instalaci\xf3n Red Privada EOSIO",sidebar_label:"Instalaci\xf3n Red Privada EOSIO"},l=void 0,d={unversionedId:"tutoriales/instalacion-de-red-privada",id:"tutoriales/instalacion-de-red-privada",isDocsHomePage:!1,title:"Instalaci\xf3n Red Privada EOSIO",description:"Tutorial de Configuraci\xf3n de una Red Privada",source:"@site/docs/tutoriales/instalacion-de-red-privada.md",sourceDirName:"tutoriales",slug:"/tutoriales/instalacion-de-red-privada",permalink:"/docs/tutoriales/instalacion-de-red-privada",editUrl:"https://github.com/eoscostarica/guias.eoscostarica.io/tree/master/docs/tutoriales/instalacion-de-red-privada.md",version:"current",lastUpdatedBy:"Leister Francisco Alvarez Campos",lastUpdatedAt:1625690268,formattedLastUpdatedAt:"7/7/2021",frontMatter:{id:"instalacion-de-red-privada",title:"Instalaci\xf3n Red Privada EOSIO",sidebar_label:"Instalaci\xf3n Red Privada EOSIO"},sidebar:"docs",previous:{title:"Instalaci\xf3n de Nodos",permalink:"/docs/tutoriales/instalacion-de-nodos"},next:{title:"Kubernetes",permalink:"/docs/tutoriales/kubernetes"}},p=[{value:"Tutorial de Configuraci\xf3n de una Red Privada",id:"tutorial-de-configuraci\xf3n-de-una-red-privada",children:[]},{value:"Requisitos Previos de Software",id:"requisitos-previos-de-software",children:[{value:"Instalaci\xf3n de los Binarios Precompilados de EOSIO",id:"instalaci\xf3n-de-los-binarios-precompilados-de-eosio",children:[]}]},{value:"Iniciar el Servicio nodeos",id:"iniciar-el-servicio-nodeos",children:[]},{value:"Registros del Servicio nodeos",id:"registros-del-servicio-nodeos",children:[]},{value:"Configuraci\xf3n y Compilaci\xf3n de <code>eosio.contracts</code>",id:"configuraci\xf3n-y-compilaci\xf3n-de-eosiocontracts",children:[]},{value:"Despliegue del Contrato <code>eosio.bios</code>",id:"despliegue-del-contrato-eosiobios",children:[{value:"Activar <code>PREACTIVATE_FEATURE</code>",id:"activar-preactivate_feature",children:[]},{value:"Despliegue de la Versi\xf3n <strong>Antigua</strong> de los Contratos",id:"despliegue-de-la-versi\xf3n-antigua-de-los-contratos",children:[]},{value:"Desplegar la \xdaltima Versi\xf3n de los Contratos",id:"desplegar-la-\xfaltima-versi\xf3n-de-los-contratos",children:[]}]},{value:"Nodos Productores de Bloques: Configuraci\xf3n y Ejecuci\xf3n",id:"nodos-productores-de-bloques-configuraci\xf3n-y-ejecuci\xf3n",children:[{value:"<code>config.ini</code>",id:"configini",children:[]},{value:"<code>genesis.json</code>",id:"genesisjson",children:[]},{value:"<code>start.sh</code>",id:"startsh",children:[]}]},{value:"Crear Cuentas de Productores de Bloques",id:"crear-cuentas-de-productores-de-bloques",children:[]},{value:"Configurar el Schedule de los Productores",id:"configurar-el-schedule-de-los-productores",children:[]},{value:"Nodo API: Configuraci\xf3n y Ejecuci\xf3n",id:"nodo-api-configuraci\xf3n-y-ejecuci\xf3n",children:[{value:"<code>config.ini</code>",id:"configini-1",children:[]},{value:"<code>genesis.json</code>",id:"genesisjson-1",children:[]},{value:"<code>start.sh</code>",id:"startsh-1",children:[]}]},{value:"Nodo Semilla: Configuraci\xf3n y Ejecuci\xf3n",id:"nodo-semilla-configuraci\xf3n-y-ejecuci\xf3n",children:[{value:"<code>config.ini</code>",id:"configini-2",children:[]},{value:"<code>genesis.json</code>",id:"genesisjson-2",children:[]},{value:"<code>start.sh</code>",id:"startsh-2",children:[]}]},{value:"Detener el Servicio nodeos",id:"detener-el-servicio-nodeos",children:[]},{value:"Reiniciar el Servicio nodeos",id:"reiniciar-el-servicio-nodeos",children:[]},{value:"Reiniciar nodeos desde Cero",id:"reiniciar-nodeos-desde-cero",children:[]},{value:"Interactuar con la Red",id:"interactuar-con-la-red",children:[{value:"Obtener Datos Almacenados",id:"obtener-datos-almacenados",children:[]}]}],u={toc:p};function _(e){var n=e.components,a=(0,i.Z)(e,r);return(0,t.kt)("wrapper",(0,o.Z)({},u,a,{components:n,mdxType:"MDXLayout"}),(0,t.kt)("h2",{id:"tutorial-de-configuraci\xf3n-de-una-red-privada"},"Tutorial de Configuraci\xf3n de una Red Privada"),(0,t.kt)("p",null,"Se pueden dise\xf1ar varias topolog\xedas en el sentido de cantidad de nodos o redundancia de los datos, sin embargo, para la practicidad de este tutorial, se utiliza la siguiente topolog\xeda como referencia principal:"),(0,t.kt)("p",{style:{align:"center"}},(0,t.kt)("img",{src:(0,s.Z)("/img/private-network-installation-tutorial/initial-topology.png"),width:"100%"})),(0,t.kt)("h2",{id:"requisitos-previos-de-software"},"Requisitos Previos de Software"),(0,t.kt)("p",null,"A la hora de configurar una red privada EOSIO hay algunos requisitos de instalaci\xf3n de software:"),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"Instalaci\xf3n de los binarios precompilados de EOSIO"),(0,t.kt)("li",{parentName:"ol"},"Instalaci\xf3n de los binarios EOSIO.CDT")),(0,t.kt)("p",null,(0,t.kt)("em",{parentName:"p"},"Adem\xe1s, estamos utilizando Ubuntu 18.04 LTS, pero si quieres utilizar macOS u otro sistema operativo compatible, echa un vistazo a ",(0,t.kt)("a",{parentName:"em",href:"https://github.com/EOSIO/eos/releases"},"EOSIO releases"))),(0,t.kt)("h3",{id:"instalaci\xf3n-de-los-binarios-precompilados-de-eosio"},"Instalaci\xf3n de los Binarios Precompilados de EOSIO"),(0,t.kt)("p",null,"Ejecute los siguientes comandos para instalar los binarios precompilados de EOSIO:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ wget https://github.com/eosio/eos/releases/download/v2.0.9/eosio_2.0.9-1-ubuntu-18.04_amd64.deb\n$ sudo apt install ./eosio_2.0.9-1-ubuntu-18.04_amd64.deb\n")),(0,t.kt)("p",null,"Una vez instalados los binarios de EOSIO; nodeos, una configuraci\xf3n de blockchain desde cero e interacciones con redes P2P son algunas de las funcionalidades disponibles que ofrece el protocolo."),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"Para desinstalar EOSIO ejecute ",(0,t.kt)("inlineCode",{parentName:"p"},"$ sudo apt remove eosio")),(0,t.kt)("h3",{parentName:"blockquote",id:"instalaci\xf3n-de-los-binarios-eosiocdt-contract-development-toolkit"},"Instalaci\xf3n de los Binarios EOSIO.CDT (Contract Development Toolkit)"),(0,t.kt)("p",{parentName:"blockquote"},"EOSIO.CDT es un kit de herramientas que facilita el desarrollo de contratos inteligentes en una red de blockchain EOSIO. Para instalar EOSIO.CDT v1.6.3 ejecute los siguientes comandos:"),(0,t.kt)("pre",{parentName:"blockquote"},(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ wget https://github.com/eosio/eosio.cdt/releases/download/v1.6.3/eosio.cdt_1.6.3-1-ubuntu-18.04_amd64.deb\n$ sudo apt install ./eosio.cdt_1.6.3-1-ubuntu-18.04_amd64.deb\n")),(0,t.kt)("h2",{parentName:"blockquote",id:"configuraci\xf3n-del-nodo-g\xe9nesis"},"Configuraci\xf3n del Nodo G\xe9nesis"),(0,t.kt)("p",{parentName:"blockquote"},"Antes de configurar el nodo g\xe9nesis, es necesario crear un directorio llamado ",(0,t.kt)("inlineCode",{parentName:"p"},"~/biosboot/genesis"),", esto debido a las particularidades del protocolo. As\xed que, para esto ejecute lo siguiente:"),(0,t.kt)("pre",{parentName:"blockquote"},(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ mkdir ~/biosboot\n$ mkdir ~/biosboot/genesis\n")),(0,t.kt)("p",{parentName:"blockquote"},"Ahora, crea un archivo llamado ",(0,t.kt)("inlineCode",{parentName:"p"},"genesis.json")," en el directorio ",(0,t.kt)("inlineCode",{parentName:"p"},"~/biosboot/"),", para ello ejecuta el siguiente comando para crear y editar el archivo:"),(0,t.kt)("pre",{parentName:"blockquote"},(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ nano ~/biosboot/genesis.json\n")),(0,t.kt)("p",{parentName:"blockquote"},"Copie y pegue el siguiente contenido en el archivo creado anteriormente:"),(0,t.kt)("pre",{parentName:"blockquote"},(0,t.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "initial_timestamp": "2018-12-05T08:55:11.000",\n  "initial_key": "EOS_PUB_DEV_KEY",\n  "initial_configuration": {\n    "max_block_net_usage": 1048576,\n    "target_block_net_usage_pct": 1000,\n    "max_transaction_net_usage": 524288,\n    "base_per_transaction_net_usage": 12,\n    "net_usage_leeway": 500,\n    "context_free_discount_net_usage_num": 20,\n    "context_free_discount_net_usage_den": 100,\n    "max_block_cpu_usage": 100000,\n    "target_block_cpu_usage_pct": 500,\n    "max_transaction_cpu_usage": 50000,\n    "min_transaction_cpu_usage": 100,\n    "max_transaction_lifetime": 3600,\n    "deferred_trx_expiration_window": 600,\n    "max_transaction_delay": 3888000,\n    "max_inline_action_size": 4096,\n    "max_inline_action_depth": 4,\n    "max_authority_depth": 6\n  },\n  "initial_chain_id": "0000000000000000000000000000000000000000000000000000000000000000"\n}\n')),(0,t.kt)("p",{parentName:"blockquote"},"Esto puede ser cambiado m\xe1s adelante utilizando la funci\xf3n privilegiada ",(0,t.kt)("inlineCode",{parentName:"p"},"set_param"),". Puedes ver m\xe1s ",(0,t.kt)("a",{parentName:"p",href:"https://guias.eoscostarica.io/docs/aprender-eosio/funciones-importantes#docsNav"},"aqu\xed"))),(0,t.kt)("h2",{id:"iniciar-el-servicio-nodeos"},"Iniciar el Servicio nodeos"),(0,t.kt)("p",null,"Antes de iniciar el servicio nodeos, es necesario crear el archivo ",(0,t.kt)("inlineCode",{parentName:"p"},"genesis_start.sh"),". Para ello, ejecute los siguientes comandos:"),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Cree el archivo"),(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~/biosboot/genesis\n$ nano genesis_start.sh\n"))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Pegue el siguiente contenido en el archivo ",(0,t.kt)("inlineCode",{parentName:"p"},"genesis_start.sh"),":"),(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\nDATADIR="./blockchain"\n\nif [ ! -d $DATADIR ]; then  mkdir -p $DATADIR;\nfi\n\nnodeos \\\n  --genesis-json $DATADIR"/../../genesis.json" \\\n  --signature-provider EOS_PUB_DEV_KEY=KEY:EOS_PRIV_DEV_KEY \\\n  --plugin eosio::producer_plugin \\\n  --plugin eosio::producer_api_plugin \\\n  --plugin eosio::chain_plugin \\\n  --plugin eosio::chain_api_plugin \\\n  --plugin eosio::http_plugin \\\n  --plugin eosio::history_api_plugin \\\n  --plugin eosio::history_plugin \\\n  --data-dir $DATADIR"/data" \\\n  --blocks-dir $DATADIR"/blocks" \\\n  --config-dir $DATADIR"/config" \\\n  --producer-name eosio \\\n  --http-server-address IP_NODO_GENESIS:8888 \\\n  --p2p-listen-endpoint IP_NODO_GENESIS:9010 \\\n  --access-control-allow-origin=* \\\n  --contracts-console \\\n  --http-validate-host=false \\\n  --verbose-http-errors \\\n  --enable-stale-production \\\n  --p2p-peer-address IP_PRODUCTOR1:9011 \\\n  --p2p-peer-address IP_PRODUCTOR2:9012 \\\n  --p2p-peer-address IP_PRODUCTOR2:9013 \\\n>> $DATADIR"/nodeos.log" 2>&1 & \\\necho $! > $DATADIR"/eosd.pid"\n')),(0,t.kt)("blockquote",{parentName:"li"},(0,t.kt)("p",{parentName:"blockquote"},"Recuerde reemplazar ",(0,t.kt)("inlineCode",{parentName:"p"},"EOS_PUB_DEV_KEY")," y ",(0,t.kt)("inlineCode",{parentName:"p"},"EOS_PRIV_DEV_KEY")," con el par de claves generado anteriormente."))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Por \xfaltimo, asigne permiso de ejecuci\xf3n al script:"),(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~/biosboot/genesis/\n$ chmod 755 genesis_start.sh\n$ ./genesis_start.sh\n")),(0,t.kt)("p",{parentName:"li"},"Una vez ejecutado el comando anterior, el nodo g\xe9nesis que llevar\xe1 ",(0,t.kt)("strong",{parentName:"p"},"eosio")," como nombre podr\xe1:")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Producir bloques")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Escuchar peticiones HTTP en ",(0,t.kt)("inlineCode",{parentName:"p"},"IP_NODO_GENESIS:8888"),".")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Escuchar solicitudes de conexi\xf3n con otros nodos en ",(0,t.kt)("inlineCode",{parentName:"p"},"IP_NODO_GENESIS:9010"),".")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Imprimir la salida de los contratos inteligentes en el terminal"))),(0,t.kt)("h2",{id:"registros-del-servicio-nodeos"},"Registros del Servicio nodeos"),(0,t.kt)("p",null,"Puedes inspeccionar los registros de servicios de nodeos con los siguientes comandos:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~/biosboot/genesis/\n$ tail -f ./blockchain/nodeos.log\n")),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"Para salir del modo de impresi\xf3n de registros, pulse CTRL+C.")),(0,t.kt)("h2",{id:"configuraci\xf3n-y-compilaci\xf3n-de-eosiocontracts"},"Configuraci\xf3n y Compilaci\xf3n de ",(0,t.kt)("inlineCode",{parentName:"h2"},"eosio.contracts")),(0,t.kt)("p",null,"Es necesario instalar la \xfaltima versi\xf3n de ",(0,t.kt)("inlineCode",{parentName:"p"},"eosio.contracts")," junto con la versi\xf3n ",(0,t.kt)("strong",{parentName:"p"},"v1.8.0"),". Para facilitar la comprensi\xf3n de los pasos aqu\xed descritos, la \xfaltima versi\xf3n ser\xe1 referida como ",(0,t.kt)("inlineCode",{parentName:"p"},"EOSIO_CONTRACTS_DIRECTORY")," y la ",(0,t.kt)("inlineCode",{parentName:"p"},"v1.8.0")," como ",(0,t.kt)("inlineCode",{parentName:"p"},"EOSIO_OLD_CONTRACTS_DIRECTORY"),".\nLos siguientes pasos de instalaci\xf3n deben seguirse en el orden en que aparecen."),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"Clone y compile los ",(0,t.kt)("inlineCode",{parentName:"li"},"eosio.contracts"),":",(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~\n$ git clone https://github.com/EOSIO/eosio.contracts.git\n$ cd ./eosio.contracts/\n$ ./build.sh\n$ cd ./build/contracts/\n"))),(0,t.kt)("li",{parentName:"ol"},"Clone e instale ",(0,t.kt)("inlineCode",{parentName:"li"},"eosio.cdt")," ",(0,t.kt)("inlineCode",{parentName:"li"},"v1.6.3"),":",(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ wget https://github.com/eosio/eosio.cdt/releases/download/v1.6.3/eosio.cdt_1.6.3-1-ubuntu-18.04_amd64.deb\n$ sudo apt install ./eosio.cdt_1.6.3-1-ubuntu-18.04_amd64.deb\n"))),(0,t.kt)("li",{parentName:"ol"},"Clone y compile ",(0,t.kt)("inlineCode",{parentName:"li"},"eosio.contracts")," ",(0,t.kt)("inlineCode",{parentName:"li"},"v1.8.0"),":",(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~\n$ git clone https://github.com/EOSIO/eosio.contracts.git eosio.contracts-1.8.x\n$ cd ./eosio.contracts-1.8.x/\n$ git checkout release/1.8.x\n$ ./build.sh\n$ cd ./build/contracts/\n")))),(0,t.kt)("h2",{id:"despliegue-del-contrato-eosiobios"},"Despliegue del Contrato ",(0,t.kt)("inlineCode",{parentName:"h2"},"eosio.bios")),(0,t.kt)("h3",{id:"activar-preactivate_feature"},"Activar ",(0,t.kt)("inlineCode",{parentName:"h3"},"PREACTIVATE_FEATURE")),(0,t.kt)("p",null,"Debido a las actualizaciones introducidas en la v1.8 y v2.0, es necesario activar una caracter\xedstica del protocolo llamada PREACTIVATE_FEATURE. Para activar esta caracter\xedstica, ejecute el siguiente comando:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'$ curl --request POST \\\n    --url http://IP_NODO_GENESIS:8888/v1/producer/schedule_protocol_feature_activations \\\n    -d \'{"protocol_features_to_activate": ["0ec7e080177b2c02b278d5088611686b49d739925a92d9bfcacd7fc6b74053bd"]}\' \n')),(0,t.kt)("h3",{id:"despliegue-de-la-versi\xf3n-antigua-de-los-contratos"},"Despliegue de la Versi\xf3n ",(0,t.kt)("strong",{parentName:"h3"},"Antigua")," de los Contratos"),(0,t.kt)("p",null,"Ahora es necesario desplegar la versi\xf3n antigua de los contratos inteligentes (",(0,t.kt)("inlineCode",{parentName:"p"},"EOSIO_OLD_CONTRACTS_DIRECTORY"),"), para ello ejecuta el siguiente comando:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cleos set contract eosio EOSIO_OLD_CONTRACTS_DIRECTORY/eosio.bios/\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"Salida de consola esperada")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'Reading WAST/WASM from /users/documents/eos/build/contracts/eosio.bios/eosio.bios.wasm...\nUsing already assembled WASM...\nPublishing contract...\nexecuted transaction: 2150ed87e4564cd3fe98ccdea841dc9ff67351f9315b6384084e8572a35887cc  39968 bytes  4395 us\n#         eosio <= eosio::setcode               {"account":"eosio","vmtype":0,"vmversion":0,"code":"0061736d0100000001be023060027f7e0060067f7e7e7f7f...\n#         eosio <= eosio::setabi                {"account":"eosio","abi":{"types":[],"structs":[{"name":"buyrambytes","base":"","fields":[{"name":"p...\n')),(0,t.kt)("p",null,"Ahora que se ha desplegado la versi\xf3n antigua de los contratos, tambi\xe9n es necesario activar las caracter\xedsticas especiales que se recomiendan para las redes basadas en el protocolo EOSIO. Para activar estas caracter\xedsticas, ejecute los siguientes comandos:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"# GET_SENDER\ncleos push action eosio activate '[\"f0af56d2c5a48d60a4a5b5c903edfb7db3a736a94ed589d0b797df33ff9d3e1d\"]' -p eosio\n\n# FORWARD_SETCODE\ncleos push action eosio activate '[\"2652f5f96006294109b3dd0bbde63693f55324af452b799ee137a81a905eed25\"]' -p eosio\n\n# ONLY_BILL_FIRST_AUTHORIZER\ncleos push action eosio activate '[\"8ba52fe7a3956c5cd3a656a3174b931d3bb2abb45578befc59f283ecd816a405\"]' -p eosio\n\n# RESTRICT_ACTION_TO_SELF\ncleos push action eosio activate '[\"ad9e3d8f650687709fd68f4b90b41f7d825a365b02c23a636cef88ac2ac00c43\"]' -p eosio\n\n# DISALLOW_EMPTY_PRODUCER_SCHEDULE\ncleos push action eosio activate '[\"68dcaa34c0517d19666e6b33add67351d8c5f69e999ca1e37931bc410a297428\"]' -p eosio\n\n # FIX_LINKAUTH_RESTRICTION\ncleos push action eosio activate '[\"e0fb64b1085cc5538970158d05a009c24e276fb94e1a0bf6a528b48fbc4ff526\"]' -p eosio\n\n # REPLACE_DEFERRED\ncleos push action eosio activate '[\"ef43112c6543b88db2283a2e077278c315ae2c84719a8b25f25cc88565fbea99\"]' -p eosio\n\n# NO_DUPLICATE_DEFERRED_ID\ncleos push action eosio activate '[\"4a90c00d55454dc5b059055ca213579c6ea856967712a56017487886a4d4cc0f\"]' -p eosio\n\n# ONLY_LINK_TO_EXISTING_PERMISSION\ncleos push action eosio activate '[\"1a99a59d87e06e09ec5b028a9cbb7749b4a5ad8819004365d02dc4379a8b7241\"]' -p eosio\n\n# RAM_RESTRICTIONS\ncleos push action eosio activate '[\"4e7bf348da00a945489b2a681749eb56f5de00b900014e137ddae39f48f69d67\"]' -p eosio\n\n# WEBAUTHN_KEY\ncleos push action eosio activate '[\"4fca8bd82bbd181e714e283f83e1b45d95ca5af40fb89ad3977b653c448f78c2\"]' -p eosio\n\n# WTMSIG_BLOCK_SIGNATURES\ncleos push action eosio activate '[\"299dcb6af692324b899b39f16d5a530a33062804e41f09dc97e9f156b4476707\"]' -p eosio\n")),(0,t.kt)("h3",{id:"desplegar-la-\xfaltima-versi\xf3n-de-los-contratos"},"Desplegar la \xdaltima Versi\xf3n de los Contratos"),(0,t.kt)("p",null,"Una vez desplegada la versi\xf3n antigua de los contratos y activadas las caracter\xedsticas, se procede a desplegar la versi\xf3n reciente de los contratos:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cleos -U http://IP_NODO_GENESIS:8888 set contract eosio.bios EOSIO_CONTRACTS_DIRECTORY/eosio.bios/\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"Salida esperada de consola:")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'Reading WAST/WASM from \xb7/users/documents/eos/contracts/eosio.bios/eosio.bios.wasm...\nUsing already assembled WASM...\nPublishing contract...\nexecuted transaction: 17fa4e06ed0b2f52cadae2cd61dee8fb3d89d3e46d5b133333816a04d23ba991  8024 bytes  974 us\n#         eosio <= eosio::setcode               {"account":"eosio.bios","vmtype":0,"vmversion":0,"code":"0061736d01000000017f1560037f7e7f0060057f7e...\n#         eosio <= eosio::setabi                {"account":"eosio.bios","abi":{"types":[],"structs":[{"name":"transfer","base":"","fields":[{"name"...\n')),(0,t.kt)("h2",{id:"nodos-productores-de-bloques-configuraci\xf3n-y-ejecuci\xf3n"},"Nodos Productores de Bloques: Configuraci\xf3n y Ejecuci\xf3n"),(0,t.kt)("p",null,"Debemos crear los archivos de configuraci\xf3n para cada productor de bloques en cada servidor. Dado que en la ",(0,t.kt)("a",{parentName:"p",href:"#tutorial-de-configuraci%C3%B3n-de-una-red-privada"},"topolog\xeda")," se han concebido tres productores de bloques, vamos a proceder a crear sus archivos correspondientes. Para ello, ejecute los siguientes comandos:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~\n$ mkdir productor1\n\n$ touch ~/productor1/config.ini\n$ touch ~/productor1/genesis.json\n$ touch ~/productor1/start.sh\n")),(0,t.kt)("p",null,"Una vez creados los archivos, copie el contenido del fragmento de c\xf3digo en cada archivo correspondiente y repita el proceso para cada directorio en cada servidor (cambie el nombre del directorio seg\xfan el nodo):"),(0,t.kt)("h3",{id:"configini"},(0,t.kt)("inlineCode",{parentName:"h3"},"config.ini")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"agent-name = productor1 # CAMBIAR ESTO DE ACUERDO AL NOMBRE DEL NODO\n\n# PLUGINS\nplugin = eosio::chain_plugin\nplugin = eosio::chain_api_plugin\nplugin = eosio::http_plugin\nplugin = eosio::producer_plugin\nplugin = eosio::producer_api_plugin\n# CHAIN \nchain-state-db-size-mb = 16384\nreversible-blocks-db-size-mb = 512\ncontracts-console = true\nabi-serializer-max-time-ms = 2000\nwasm-runtime = wabt\nenable-stale-production = false\npause-on-startup = false\nmax-irreversible-block-age = -1\ntxn-reference-block-lag = 0\n\n# BLOCK PRODUCER\nproducer-name = productor1 # CAMBIAR ESTO DE ACUERDO AL SERVIDOR\n\n# PEERING NETWORK\np2p-server-address =  IP_PRODUCTOR1:9876     # CAMBIAR ESTO DE ACUERDO A LA IP DEL SERVIDOR\np2p-listen-endpoint = 0.0.0.0:9876\np2p-max-nodes-per-host = 150\nmax-clients = 150\nconnection-cleanup-period = 30\nsync-fetch-span = 2000\nallowed-connection = any\n\np2p-peer-address = IP_NODO_SEMILLA:PUERTO_NODO_SEMILLA\np2p-peer-address = IP_PRODUCTOR2:PUERTO_PRODUCTOR2       # CAMBIAR ESTO DE ACUERDO AL NODO\np2p-peer-address = IP_PRODUCTOR3:PUERTO_PRODUCTOR3       # CAMBIAR ESTO DE ACUERDO AL NODO\np2p-peer-address = IP_NODO_API:PUERTO_NODO_API\n")),(0,t.kt)("h3",{id:"genesisjson"},(0,t.kt)("inlineCode",{parentName:"h3"},"genesis.json")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "initial_timestamp": "2018-12-05T08:55:11.000",\n  "initial_key": "EOS_PUB_DEV_KEY",\n  "initial_configuration": {\n    "max_block_net_usage": 1048576,\n    "target_block_net_usage_pct": 1000,\n    "max_transaction_net_usage": 524288,\n    "base_per_transaction_net_usage": 12,\n    "net_usage_leeway": 500,\n    "context_free_discount_net_usage_num": 20,\n    "context_free_discount_net_usage_den": 100,\n    "max_block_cpu_usage": 100000,\n    "target_block_cpu_usage_pct": 500,\n    "max_transaction_cpu_usage": 50000,\n    "min_transaction_cpu_usage": 100,\n    "max_transaction_lifetime": 3600,\n    "deferred_trx_expiration_window": 600,\n    "max_transaction_delay": 3888000,\n    "max_inline_action_size": 4096,\n    "max_inline_action_depth": 4,\n    "max_authority_depth": 6\n  },\n  "initial_chain_id": "0000000000000000000000000000000000000000000000000000000000000000"\n}\n')),(0,t.kt)("h3",{id:"startsh"},(0,t.kt)("inlineCode",{parentName:"h3"},"start.sh")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'#!/usr/bin/env bash\nDATA_DIR="blockchain"\nCONFIG_DIR="./blockchain/config"\nEOS_PUB_KEY=EOS_PUB_PRODUCER1_KEY  # CAMBIAR ESTO DE ACUERDO AL NODO\nEOS_PRIV_KEY=EOS_PRIV_PRODUCER1_KEY  # CAMBIAR ESTO DE ACUERDO AL NODO\necho "Starting VALIDATOR Node...";\nset -e;\nulimit -n 65535\nulimit -s 64000\nmkdir -p $CONFIG_DIR\ncp ./config.ini $CONFIG_DIR/config.ini\npid=0;\nnodeos=$"nodeos \\\n --config-dir $CONFIG_DIR \\\n --data-dir $DATA_DIR \\\n --blocks-dir $DATA_DIR/blocks \\\n --signature-provider $EOS_PUB_KEY=KEY:$EOS_PRIV_KEY" ;\nterm_handler() {\n if [ $pid -ne 0 ]; then\n   kill -SIGTERM "$pid";\n   wait "$pid";\n fi\n exit 0;\n}\nstart_nodeos() {\n $nodeos &\n sleep 10;\n if [ -z "$(pidof nodeos)" ]; then\n   $nodeos --hard-replay-blockchain &\n fi\n}\nstart_fresh_nodeos() {\n echo \'Starting new chain from genesis JSON\'\n $nodeos --delete-all-blocks --genesis-json genesis.json &\n}\ntrap \'echo "Shutdown of EOSIO service...";kill ${!}; term_handler\' 2 15;\nif [ ! -d $DATA_DIR/blocks ]; then\n start_fresh_nodeos &\nelif [ -d $DATA_DIR/blocks ]; then\n start_nodeos &\nfi\npid="$(pidof nodeos)"\nwhile true\ndo\n tail -f /dev/null & wait ${!}\ndone\n')),(0,t.kt)("p",null,"Para ejecutar cada nodo es necesario entrar en el directorio, asignar permisos y ejecutar cada archivo ",(0,t.kt)("inlineCode",{parentName:"p"},"start.sh"),":"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod 755 start.sh # asigna permisos de ejecuci\xf3n\n$ ./start.sh\n")),(0,t.kt)("h2",{id:"crear-cuentas-de-productores-de-bloques"},"Crear Cuentas de Productores de Bloques"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cleos -u http://IP_NODO_GENESIS:8888 create account eosio producer1 EOS_PUB_PRODUCER1_KEY\n$ cleos -u http://IP_NODO_GENESIS:8888 create account eosio producer2 EOS_PUB_PRODUCER2_KEY\n$ cleos -u http://IP_NODO_GENESIS:8888 create account eosio producer3 EOS_PUB_PRODUCER3_KEY\n")),(0,t.kt)("h2",{id:"configurar-el-schedule-de-los-productores"},"Configurar el Schedule de los Productores"),(0,t.kt)("p",null,"Crea el archivo ",(0,t.kt)("inlineCode",{parentName:"p"},"producers.json")," y pega el siguiente contenido en \xe9l:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-json"},'{"schedule":\n  [\n    {\n      "producer_name": "productor1", \n      "authority": [\n        "block_signing_authority_v0",\n        {\n          "threshold": 1,\n          "keys": [\n            {\n              "key":"EOS_PUB_PRODUCER1_KEY",\n              "weight":1\n            }\n          ]\n        }\n      ]\n    },\n    {\n      "producer_name":"productor2",\n      "authority": [\n        "block_signing_authority_v0",\n        {\n          "threshold":1,\n          "keys": [\n            {\n              "key":"EOS_PUB_PRODUCER2_KEY",\n              "weight":1\n            }\n          ]\n        }\n      ]\n    },\n    {\n      "producer_name":"productor3",\n      "authority": [\n        "block_signing_authority_v0",\n        {\n          "threshold":1,\n          "keys": [\n            {\n              "key":"EOS_PUB_PRODUCER3_KEY",\n              "weight":1\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n')),(0,t.kt)("p",null,"Ahora, ejecute el siguiente comando para establecer el ",(0,t.kt)("em",{parentName:"p"},"schedule"),":"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'$ cleos -u http://IP_NODO_GENESIS:8888 push action eosio setprods "producers.json" -p eosio@active\n')),(0,t.kt)("h2",{id:"nodo-api-configuraci\xf3n-y-ejecuci\xf3n"},"Nodo API: Configuraci\xf3n y Ejecuci\xf3n"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~\n$ mkdir nodo-api\n$ cd nodo-api\n$ touch config.ini\n$ touch genesis.json\n$ touch start.sh\n")),(0,t.kt)("p",null,"Ahora copie el contenido del fragmento de c\xf3digo en el archivo correspondiente:"),(0,t.kt)("h3",{id:"configini-1"},(0,t.kt)("inlineCode",{parentName:"h3"},"config.ini")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"agent-name = nodo-api\n\n# PLUGINS\nplugin = eosio::chain_plugin\nplugin = eosio::chain_api_plugin\nplugin = eosio::http_plugin\nplugin = eosio::producer_plugin\nplugin = eosio::producer_api_plugin\n# HTTP\naccess-control-allow-origin = *\nhttp-validate-host = false\nverbose-http-errors = true\nhttp-server-address = 0.0.0.0:80\n\n# SSL\n#https-server-address = 0.0.0.0:443\n#https-certificate-chain-file = ./ssl/eosio.cr.crt\n#https-private-key-file = ./ssl/eosio.cr.priv.key\n\n# CHAIN \nchain-state-db-size-mb = 16384\nreversible-blocks-db-size-mb = 512\nabi-serializer-max-time-ms = 2000   \ncontracts-console = true\n\n# PEERING NETWORK\np2p-listen-endpoint = 0.0.0.0:9876\np2p-server-address =  IP_NODO_API:9876\np2p-max-nodes-per-host = 150\nmax-clients = 150\nsync-fetch-span = 2000\n\np2p-peer-address = IP_PRODUCTOR1:PUERTO_PRODUCTOR1\np2p-peer-address = IP_PRODUCTOR2:PUERTO_PRODUCTOR2\np2p-peer-address = IP_PRODUCTOR3:PUERTO_PRODUCTOR3\np2p-peer-address = IP_NODO_SEMILLA:PUERTO_NODO_SEMILLA\n")),(0,t.kt)("h3",{id:"genesisjson-1"},(0,t.kt)("inlineCode",{parentName:"h3"},"genesis.json")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-json"},'{\n "initial_timestamp": "2018-12-05T08:55:11.000",\n "initial_key": "EOS_PUB_DEV_KEY",\n "initial_configuration": {\n   "max_block_net_usage": 1048576,\n   "target_block_net_usage_pct": 1000,\n   "max_transaction_net_usage": 524288,\n   "base_per_transaction_net_usage": 12,\n   "net_usage_leeway": 500,\n   "context_free_discount_net_usage_num": 20,\n   "context_free_discount_net_usage_den": 100,\n   "max_block_cpu_usage": 100000,\n   "target_block_cpu_usage_pct": 500,\n   "max_transaction_cpu_usage": 50000,\n   "min_transaction_cpu_usage": 100,\n   "max_transaction_lifetime": 3600,\n   "deferred_trx_expiration_window": 600,\n   "max_transaction_delay": 3888000,\n   "max_inline_action_size": 4096,\n   "max_inline_action_depth": 4,\n   "max_authority_depth": 6\n },\n "initial_chain_id": "0000000000000000000000000000000000000000000000000000000000000000"\n}\n')),(0,t.kt)("h3",{id:"startsh-1"},(0,t.kt)("inlineCode",{parentName:"h3"},"start.sh")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'#!/usr/bin/env bash\nDATA_DIR="blockchain"\nCONFIG_DIR="./blockchain/config"\necho "Starting API Node...";\nset -e;\nulimit -n 65535\nulimit -s 64000\nmkdir -p $CONFIG_DIR\ncp ./config.ini $CONFIG_DIR/config.ini\npid=0;\nnodeos=$"nodeos \\\n --config-dir $CONFIG_DIR \\\n --data-dir $DATA_DIR \\\n --blocks-dir $DATA_DIR/blocks" ;\nterm_handler() {\n if [ $pid -ne 0 ]; then\n   kill -SIGTERM "$pid";\n   wait "$pid";\n fi\n exit 0;\n}\nstart_nodeos() {\n $nodeos &\n sleep 10;\n if [ -z "$(pidof nodeos)" ]; then\n   $nodeos --hard-replay-blockchain &\n fi\n}\nstart_fresh_nodeos() {\n echo \'Starting new chain from genesis JSON\'\n $nodeos --delete-all-blocks --genesis-json genesis.json &\n}\ntrap \'echo "Shutdown of EOSIO service...";kill ${!}; term_handler\' 2 15;\nif [ ! -d $DATA_DIR/blocks ]; then\n start_fresh_nodeos &\nelif [ -d $DATA_DIR/blocks ]; then\n start_nodeos &\nfi\npid="$(pidof nodeos)"\nwhile true\ndo\n tail -f /dev/null & wait ${!}\ndone\n')),(0,t.kt)("p",null,"Para iniciar el nodo, asigne permisos de ejecuci\xf3n a ",(0,t.kt)("inlineCode",{parentName:"p"},"start.sh")," y ejec\xfatelo:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod 755 start.sh\n$ ./start.sh\n")),(0,t.kt)("h2",{id:"nodo-semilla-configuraci\xf3n-y-ejecuci\xf3n"},"Nodo Semilla: Configuraci\xf3n y Ejecuci\xf3n"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~\n$ mkdir nodo-semilla\n$ touch config.ini\n$ touch genesis.json\n$ touch start.sh \n")),(0,t.kt)("p",null,"Ahora copie el contenido del fragmento de c\xf3digo en el archivo correspondiente:"),(0,t.kt)("h3",{id:"configini-2"},(0,t.kt)("inlineCode",{parentName:"h3"},"config.ini")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"# EOSIO Testnet SEED NODE Config file\n# https://eoscostarica.io\n\nagent-name = nodo-semilla\n\n# PLUGINS\nplugin = eosio::chain_plugin\n\n# CHAIN \nchain-state-db-size-mb = 16384\nreversible-blocks-db-size-mb = 512\ncontracts-console = true\nabi-serializer-max-time-ms = 2000\n\n# PEERING NETWORK\np2p-listen-endpoint = 0.0.0.0:9876\np2p-server-address = IP_NODO_SEMILLA:9876\n\np2p-peer-address = IP_PRODUCTOR1:PUERTO_PRODUCTOR1\np2p-peer-address = IP_PRODUCTOR2:PUERTO_PRODUCTOR2\np2p-peer-address = IP_PRODUCTOR3:PUERTO_PRODUCTOR3\np2p-peer-address = IP_NODO_API:PUERTO_NODO_API\n")),(0,t.kt)("h3",{id:"genesisjson-2"},(0,t.kt)("inlineCode",{parentName:"h3"},"genesis.json")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-json"},'{\n "initial_timestamp": "2018-12-05T08:55:11.000",\n "initial_key": "EOS_PUB_DEV_KEY",\n "initial_configuration": {\n   "max_block_net_usage": 1048576,\n   "target_block_net_usage_pct": 1000,\n   "max_transaction_net_usage": 524288,\n   "base_per_transaction_net_usage": 12,\n   "net_usage_leeway": 500,\n   "context_free_discount_net_usage_num": 20,\n   "context_free_discount_net_usage_den": 100,\n   "max_block_cpu_usage": 100000,\n   "target_block_cpu_usage_pct": 500,\n   "max_transaction_cpu_usage": 50000,\n   "min_transaction_cpu_usage": 100,\n   "max_transaction_lifetime": 3600,\n   "deferred_trx_expiration_window": 600,\n   "max_transaction_delay": 3888000,\n   "max_inline_action_size": 4096,\n   "max_inline_action_depth": 4,\n   "max_authority_depth": 6\n },\n "initial_chain_id": "0000000000000000000000000000000000000000000000000000000000000000"\n}\n')),(0,t.kt)("h3",{id:"startsh-2"},(0,t.kt)("inlineCode",{parentName:"h3"},"start.sh")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'#!/usr/bin/env bash\necho "Starting SEED Node...";\nset -e;\nulimit -n 65535\nulimit -s 64000\n\nmkdir -p $CONFIG_DIR\ncp $WORK_DIR/config.ini $CONFIG_DIR/config.ini\n\npid=0;\n\nnodeos=$"nodeos \\\n  --config-dir $CONFIG_DIR \\\n  --data-dir $DATA_DIR \\\n  --blocks-dir $DATA_DIR/blocks" ;\n\nterm_handler() {\n  if [ $pid -ne 0 ]; then\n    kill -SIGTERM "$pid";\n    wait "$pid";\n  fi\n  exit 0;\n}\n\nstart_nodeos() {\n  $nodeos &\n  sleep 10;\n  if [ -z "$(pidof nodeos)" ]; then\n    $nodeos --hard-replay-blockchain &\n  fi\n}\n\nstart_fresh_nodeos() {\n  echo \'Starting new chain from genesis JSON\'\n  $nodeos --delete-all-blocks --genesis-json $WORK_DIR/genesis.json &\n}\n\ntrap \'echo "Shutdown of EOSIO service...";kill ${!}; term_handler\' 2 15;\n\nif [ ! -d $DATA_DIR/blocks ]; then\n  start_fresh_nodeos &\nelif [ -d $DATA_DIR/blocks ]; then\n  start_nodeos &\nfi\n\npid="$(pidof nodeos)"\n\nwhile true\ndo\n  tail -f /dev/null & wait ${!}\ndone\n')),(0,t.kt)("p",null,"Para iniciar el nodo semilla, simplemente asigne permisos de ejecuci\xf3n al archivo ",(0,t.kt)("inlineCode",{parentName:"p"},"start.sh")," y ejec\xfatelo:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod 755 start.sh\n$ ./start.sh\n")),(0,t.kt)("h2",{id:"detener-el-servicio-nodeos"},"Detener el Servicio nodeos"),(0,t.kt)("p",null,"Crea el archivo ",(0,t.kt)("inlineCode",{parentName:"p"},"stop.sh")," en el directorio ",(0,t.kt)("inlineCode",{parentName:"p"},"~/biosboot/genesis/")," y copia el siguiente contenido:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\nDATADIR="./blockchain/"\n\nif [ -f $DATADIR"/eosd.pid" ]; then\n    pid=`cat $DATADIR"/eosd.pid"`\n    echo $pid\n    kill $pid\n    rm -r $DATADIR"/eosd.pid"\n    echo -ne "Stopping Node"\n    while true; do\n        [ ! -d "/proc/$pid/fd" ] && break\n        echo -ne "."\n        sleep 1\n    done\n    echo -ne "\\rNode Stopped. \\n"\nfi\n')),(0,t.kt)("p",null,"Ahora puede ejecutar el archivo ",(0,t.kt)("inlineCode",{parentName:"p"},"stop.sh"),":"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod 755 stop.sh \n$ ./stop.sh\n")),(0,t.kt)("h2",{id:"reiniciar-el-servicio-nodeos"},"Reiniciar el Servicio nodeos"),(0,t.kt)("p",null,"Es importante tener en cuenta que una vez que el nodo est\xe1 produciendo bloques no es posible reiniciar el servicio nodeos utilizando el mismo script creado en la secci\xf3n ",(0,t.kt)("a",{parentName:"p",href:"#iniciar-el-servicio-nodeos"},"Iniciar el servicio nodeos"),", ya que la base de datos del blockchain ya contiene informaci\xf3n de la ejecuci\xf3n inicial. Por eso se recomienda crear un nuevo script con el nombre ",(0,t.kt)("inlineCode",{parentName:"p"},"start.sh"),". Este archivo puede seguir utiliz\xe1ndose para futuros reinicios del nodo una vez que el proceso se haya detenido.\nCopie y pegue el siguiente contenido en el archivo ",(0,t.kt)("inlineCode",{parentName:"p"},"start.sh"),":"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\nDATADIR="./blockchain"\nEOS_PUB_KEY=EOS_PUB_KEY_HERE\nEOS_PRIV_KEY=EOS_PRIV_KEY_HERE\nif [ ! -d $DATADIR ]; then\n mkdir -p $DATADIR;\nfi\nnodeos \\\n--signature-provider EOS_PUB_KEY=KEY:EOS_PRIV_KEY \\\n--plugin eosio::producer_plugin \\\n--plugin eosio::producer_api_plugin \\\n--plugin eosio::chain_plugin \\\n--plugin eosio::chain_api_plugin \\\n--plugin eosio::http_plugin \\\n--plugin eosio::history_api_plugin \\\n--plugin eosio::history_plugin \\\n--data-dir "blockchain/data" \\\n--blocks-dir $DATADIR"/data/blockchain/blocks" \\\n--config-dir $DATADIR"/config" \\\n--producer-name eosio \\\n--http-server-address IP_NODO_GENESIS:8888 \\ # configurable\n--p2p-listen-endpoint IP_NODO_GENESIS:9010 \\ # configurable\n--access-control-allow-origin=* \\\n--contracts-console \\\n--http-validate-host=false \\\n--verbose-http-errors \\\n--enable-stale-production \\\n--p2p-peer-address IP_PRODUCTOR1:PUERTO_PRODUCTOR1 \\\n--p2p-peer-address IP_PRODUCTOR2:PUERTO_PRODUCTOR2 \\\n--p2p-peer-address IP_PRODUCTOR3:PUERTO_PRODUCTOR3 \\\n>> $DATADIR"/nodeos.log" 2>&1 & \\\necho $! > $DATADIR"/eosd.pid"\n')),(0,t.kt)("p",null,"Ahora, asigna permisos de ejecuci\xf3n al archivo ",(0,t.kt)("inlineCode",{parentName:"p"},"start.sh")," y ejec\xfatalo:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod 755 start.sh\n$ ./start.sh\n")),(0,t.kt)("p",null,"El siguiente fragmento de c\xf3digo corresponde al script ",(0,t.kt)("inlineCode",{parentName:"p"},"hard_replay.sh")," con la bandera ",(0,t.kt)("inlineCode",{parentName:"p"},"--hard-replay-blockchain"),":"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'DATADIR="./blockchain"\n\nif [ ! -d $DATADIR ]; then\n  mkdir -p $DATADIR;\nfi\n\nnodeos \\\n--signature-provider EOS_PUB_DEV_KEY=KEY:EOS_PRIV_DEV_KEY \\\n--plugin eosio::producer_plugin \\\n--plugin eosio::producer_api_plugin \\\n--plugin eosio::chain_plugin \\\n--plugin eosio::chain_api_plugin \\\n--plugin eosio::http_plugin \\\n--plugin eosio::history_api_plugin \\\n--plugin eosio::history_plugin \\\n--data-dir $DATADIR"/data" \\\n--blocks-dir $DATADIR"/blocks" \\\n--config-dir $DATADIR"/config" \\\n--producer-name eosio \\\n--http-server-address IP_NODO_GENESIS:8888 \\ # configurable\n--p2p-listen-endpoint IP_NODO_GENESIS:9010 \\ # configurable\n--access-control-allow-origin=* \\\n--contracts-console \\\n--http-validate-host=false \\\n--verbose-http-errors \\\n--enable-stale-production \\\n--p2p-peer-address IP_PRODUCTOR1:PUERTO_PRODUCTOR1 \\\n--p2p-peer-address IP_PRODUCTOR2:PUERTO_PRODUCTOR2 \\\n--p2p-peer-address IP_PRODUCTOR3:PUERTO_PRODUCTOR3 \\\n--hard-replay-blockchain \\\n>> $DATADIR"/nodeos.log" 2>&1 & \\\necho $! > $DATADIR"/eosd.pid"\n')),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},(0,t.kt)("strong",{parentName:"p"},'"perhaps we need to replay"'),": este error puede producirse al reiniciar nodeos debido a que falta la bandera ",(0,t.kt)("inlineCode",{parentName:"p"},"--hard-replay-blockchain")," (par\xe1metro que reproduce todas las transacciones del nodo g\xe9nesis). Para solucionar este error, ejecute el script ",(0,t.kt)("inlineCode",{parentName:"p"},"hard_replay.sh"),".")),(0,t.kt)("h2",{id:"reiniciar-nodeos-desde-cero"},"Reiniciar nodeos desde Cero"),(0,t.kt)("p",null,"Para reiniciar el servicio nodeos desde cero, crea el script ",(0,t.kt)("inlineCode",{parentName:"p"},"clean.sh"),", copia el siguiente contenido y dale permisos de ejecuci\xf3n (",(0,t.kt)("inlineCode",{parentName:"p"},"chmod 755 clean.sh"),"):"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\nrm -fr blockchain\nls -al\n")),(0,t.kt)("p",null,"Si desea eliminar la configuraci\xf3n actual, los datos de la cadena de bloques y los archivos de registro, ejecute los siguientes comandos en el orden en que aparecen:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~/biosboot/genesis/\n$ ./stop.sh\n$ ./clean.sh\n$ ./genesis_start.sh\n")),(0,t.kt)("h2",{id:"interactuar-con-la-red"},"Interactuar con la Red"),(0,t.kt)("p",null,"En este punto, la red es capaz de albergar cualquier contrato. Supongamos que quieres desplegar un contrato como ",(0,t.kt)("a",{parentName:"p",href:"https://github.com/eoscostarica/eoscr-smart-contracts/tree/master/easycontract"},"easycontract")," el repo de ejemplo de EOS Costa Rica. Despu\xe9s de seguir las instrucciones especificadas all\xed, puede llamar a la acci\xf3n ",(0,t.kt)("inlineCode",{parentName:"p"},"save")," de easycontract de la siguiente manera:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'cleos -u URL_NODO_AQUI push action easycontract save \'{"date":"2021/01/10 21:01:35","filename":"ejemplo.pdf","path":"/var/www/docs"}\' -p easycontract@active\n')),(0,t.kt)("p",null,"Tras la ejecuci\xf3n, obtendr\xe1 una salida en el terminal."),(0,t.kt)("h3",{id:"obtener-datos-almacenados"},"Obtener Datos Almacenados"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"cleos -u URL_NODO_AQUI get transaction ID_TRANSACCION_AQUI\n")))}_.isMDXComponent=!0}}]);